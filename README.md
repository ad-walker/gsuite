# OAuth2 Quickbooks & Google Apps Script

Update of [OAuth1 sample](https://github.com/gsuitedevs/apps-script-oauth1/blob/master/samples/QuickBooks.gs) provided by [erickoledadevrel](https://github.com/gsuitedevs/apps-script-oauth2/commits?author=erickoledadevrel). Additional OAuth2 application samples can be found here: [app-script-oauth2](https://github.com/gsuitedevs/apps-script-oauth2).

## Setup - Google Apps Script

1. Click on the menu item "_Resources > Libraries..._"
2. In the "_Find a Library_" text box, enter the script ID **1B7FSrk5Zi6L1rSxxTDgDEUsPzlukDsi4KGuTMorsTQHhGBzBkMun4iDF** and click the "_Select_" button.
3. Choose a version in the dropdown box (usually best to pick the latest version).
4. Click the "_Save_" button.

![Find Library](https://imgur.com/Gp7saFc.png)

## Intuit Developer Portal
1. Select your app from [the dashboard](https://developer.intuit.com/v2/ui#/app/dashboard).
2. Obtain your Client ID and Client Secret from the _"Keys"_ tab, paste the values into the corresponding constants. For this example we're assuming a sandbox enviornment.

![Intuit Dev Keys](https://imgur.com/w0uqND9.png)
```js
var CLIENT_ID = '...';
var CLIENT_SECRET = '...';
```
## Redirect URI

Before you can start authenticating against an OAuth2 provider, you usually need
to register your application with that OAuth2 provider and obtain a client ID
and secret. Often a provider's registration screen requires you to enter a
"Redirect URI", which is the URL that the user's browser will be redirected to
after they've authorized access to their account at that provider.

For this library (and the Apps Script functionality in general) the URL will
always be in the following format:

    https://script.google.com/macros/d/{SCRIPT ID}/usercallback

Where `{SCRIPT ID}` is the ID of the script that is using this library. You
can find your script's ID in the Apps Script code editor by clicking on
the menu item "File > Project properties".

Alternatively you can call the service's `getRedirectUri()` method to view the
exact URL that the service will use when performing the OAuth flow:

```js
/**
 * Logs the redirect URI to register.
 */
function logRedirectUri() {
  var service = getService();
  Logger.log(service.getRedirectUri());
}
```
### Add the URI to the Intuit Developer Portal
Click _Add URI_ and paste the value generated by the `logRedirectUri()` function into this field.
![Add URI](https://imgur.com/ldrpgAQ.png)

## Initialization
Execute ```function run() ``` and view the log: 

![Log](https://imgur.com/uXUKhAL.png)

Copy and paste the provided link to in your browser to complete the authorization.

![Auth](https://imgur.com/XePWYAb.png)
